<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acu Motion Wellness | Vancouver & Richmond</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts for that "One Medical" look -->
    <link href="https://fonts.googleapis.com/css2?family=Domine:wght@400;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-green': '#004d40', /* Dark green from reference */
                        'brand-cream': '#f4f4f0', /* Cream background from reference */
                        'brand-teal': '#00695c',
                        'brand-sand': '#e6e2dd',
                    },
                    fontFamily: {
                        serif: ['Domine', 'serif'],
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Custom Chatbot Animations */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .chat-animate {
            animation: slideIn 0.3s ease-out forwards;
        }
        
        /* Hide scrollbar for chat messages */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Loading Dots Animation */
        .typing-indicator span {
            display: inline-block;
            width: 6px;
            height: 6px;
            background-color: #004d40;
            border-radius: 50%;
            animation: typing 1s infinite;
            margin: 0 2px;
        }
        .typing-indicator span:nth-child(1) { animation-delay: 0.1s; }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.3s; }
        
        @keyframes typing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
    </style>
</head>
<body class="font-sans text-gray-800 antialiased">

    <!-- Navigation -->
    <nav class="fixed w-full bg-white/95 backdrop-blur-sm z-50 border-b border-gray-100 transition-all duration-300" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo Area -->
                <div class="flex-shrink-0 flex items-center gap-3 cursor-pointer" onclick="window.scrollTo(0,0)">
                    <!-- Actual Logo with Fallback for Preview -->
                    <img 
                        src="Richmond_VAN_Canada_Joanne_AcuMotionWellnessé‡ç¸_Logo.png" 
                        alt="Acu Motion Wellness Logo" 
                        class="h-16 w-auto object-contain"
                        onerror="this.style.display='none'; document.getElementById('fallback-logo').classList.remove('hidden');"
                    >
                    <!-- Fallback Icon (Visible only if image fails to load in Preview) -->
                    <div id="fallback-logo" class="hidden h-10 w-10 bg-brand-green rounded-full flex items-center justify-center text-white">
                        <i class="fa-solid fa-leaf"></i>
                    </div>
                    <span class="font-serif text-xl font-bold text-brand-green tracking-tight">Acu Motion Wellness</span>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#services" class="text-gray-600 hover:text-brand-green font-medium transition">Treatments</a>
                    <a href="#ai-wellness" class="text-gray-600 hover:text-brand-green font-medium transition flex items-center gap-1"><i class="fa-solid fa-sparkles text-amber-500 text-xs"></i> AI Wellness</a>
                    <a href="#about" class="text-gray-600 hover:text-brand-green font-medium transition">About Us</a>
                    <a href="#locations" class="text-gray-600 hover:text-brand-green font-medium transition">Locations</a>
                    <a href="https://www.acumotionwellness.com/" target="_blank" class="px-6 py-2.5 rounded-full border border-brand-green text-brand-green font-medium hover:bg-brand-green hover:text-white transition duration-300">
                        Patient Portal
                    </a>
                    <a href="#book" class="px-6 py-2.5 rounded-full bg-brand-green text-white font-medium hover:bg-brand-teal shadow-lg hover:shadow-xl transition duration-300 transform hover:-translate-y-0.5">
                        Book Appointment
                    </a>
                </div>

                <!-- Mobile menu button -->
                <div class="md:hidden flex items-center">
                    <button onclick="toggleMobileMenu()" class="text-gray-600 hover:text-brand-green focus:outline-none">
                        <i class="fa-solid fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu Panel -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100 absolute w-full">
            <div class="px-4 pt-2 pb-6 space-y-1 shadow-lg">
                <a href="#services" class="block px-3 py-3 text-base font-medium text-gray-700 hover:text-brand-green hover:bg-gray-50 rounded-md">Treatments</a>
                <a href="#ai-wellness" class="block px-3 py-3 text-base font-medium text-gray-700 hover:text-brand-green hover:bg-gray-50 rounded-md">AI Wellness Insights</a>
                <a href="#about" class="block px-3 py-3 text-base font-medium text-gray-700 hover:text-brand-green hover:bg-gray-50 rounded-md">About Us</a>
                <a href="#locations" class="block px-3 py-3 text-base font-medium text-gray-700 hover:text-brand-green hover:bg-gray-50 rounded-md">Locations</a>
                <div class="mt-4 flex flex-col gap-3">
                    <a href="#" class="w-full text-center px-6 py-3 rounded-full border border-brand-green text-brand-green font-medium">Patient Portal</a>
                    <a href="#book" class="w-full text-center px-6 py-3 rounded-full bg-brand-green text-white font-medium">Book Now</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section (One Medical Style Split) -->
    <div class="relative pt-20 lg:pt-0 min-h-screen flex flex-col lg:flex-row bg-brand-cream overflow-hidden">
        
        <!-- Left Content -->
        <div class="w-full lg:w-1/2 flex flex-col justify-center px-6 sm:px-12 lg:px-20 py-16 lg:py-0 z-10 bg-white lg:bg-transparent">
            <div class="max-w-xl">
                <h1 class="font-serif text-5xl lg:text-6xl text-brand-green leading-[1.1] mb-6">
                    Restoring balance, <br>
                    <span class="italic">naturally.</span>
                </h1>
                <p class="text-lg text-gray-600 mb-8 leading-relaxed">
                    Experience traditional Chinese medicine reimagined for modern life. 
                    Acu Motion Wellness brings expert acupuncture and holistic care to Richmond and Vancouver.
                </p>
                <div class="flex flex-col sm:flex-row gap-4">
                    <button onclick="document.getElementById('book').scrollIntoView()" class="px-8 py-4 rounded-full bg-brand-green text-white font-semibold text-lg shadow-lg hover:bg-brand-teal hover:shadow-xl transition transform hover:-translate-y-1">
                        Book Your Visit
                    </button>
                    <a href="tel:+16725335678" class="px-8 py-4 rounded-full border-2 border-brand-green text-brand-green font-semibold text-lg hover:bg-brand-green hover:text-white transition flex items-center justify-center gap-2">
                        <i class="fa-solid fa-phone"></i> (672) 533-5678
                    </a>
                </div>
                
                <div class="mt-10 flex items-center gap-4 text-sm text-gray-500">
                    <div class="flex -space-x-2">
                        <div class="w-8 h-8 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center text-xs">A</div>
                        <div class="w-8 h-8 rounded-full bg-gray-300 border-2 border-white flex items-center justify-center text-xs">M</div>
                        <div class="w-8 h-8 rounded-full bg-gray-400 border-2 border-white flex items-center justify-center text-xs">W</div>
                    </div>
                    <p>Trusted by patients in Vancouver BC</p>
                </div>
            </div>
        </div>

        <!-- Right Image Section -->
        <div class="w-full lg:w-1/2 relative min-h-[50vh] lg:min-h-screen bg-brand-sand">
            <!-- Main Background Image (Actual Photo 1 with Fallback) -->
            <img 
                src="Richmond_VAN_Canada_Joanne_AcuMotionWellnessé‡ç¸_1.png" 
                alt="Acu Motion Wellness Treatment Room" 
                class="absolute inset-0 w-full h-full object-cover object-center"
                id="hero-bg-img"
                onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1629909613654-28e377c37b09?auto=format&fit=crop&q=80&w=2068'"
            >
            
            <!-- Floating Overlay Card (Mimicking the reference design phone/app overlay) -->
            <div class="absolute bottom-10 left-10 right-10 lg:left-[-3rem] lg:right-auto lg:bottom-20 bg-white p-6 rounded-2xl shadow-2xl max-w-xs animate-fade-in-up transform hover:scale-105 transition duration-500">
                <div class="flex items-center gap-4 mb-4">
                    <div class="h-12 w-12 rounded-full bg-green-100 flex items-center justify-center text-brand-green">
                        <i class="fa-solid fa-user-doctor text-xl"></i>
                    </div>
                    <div>
                        <p class="text-sm font-bold text-gray-800">Expert Care</p>
                        <p class="text-xs text-gray-500">Licensed Practitioners</p>
                    </div>
                </div>
                <hr class="border-gray-100 mb-4">
                <!-- Secondary Image (Actual Photo 2 with Fallback) -->
                <div class="h-32 w-full bg-gray-100 rounded-lg overflow-hidden mb-3 relative group">
                    <img 
                        src="Richmond_VAN_Canada_Joanne_AcuMotionWellnessé‡ç¸_2.png" 
                        alt="Clinic Interior" 
                        class="w-full h-full object-cover group-hover:scale-110 transition duration-700"
                        id="hero-overlay-img"
                        onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1579684385180-1ea55f9f441d?auto=format&fit=crop&q=80&w=1000'"
                    >
                    <div class="absolute inset-0 bg-black/10"></div>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-xs font-semibold text-brand-green">Open Today</span>
                    <span class="text-xs text-gray-400">9:00 AM - 6:00 PM</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Features / Info Strip -->
    <div class="bg-brand-green text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left">
                <div class="flex flex-col md:flex-row items-center md:items-start gap-4">
                    <div class="p-3 bg-white/10 rounded-full">
                        <i class="fa-solid fa-location-dot text-2xl"></i>
                    </div>
                    <div>
                        <h3 class="font-serif text-xl font-bold mb-1">Visit Us</h3>
                        <p class="text-white/80 text-sm">2184 W Broadway Suite 337<br>Vancouver, BC V6K 2E1</p>
                        <a href="https://maps.app.goo.gl/Ek9eQLWAxpnngULD9" target="_blank" class="text-xs uppercase tracking-wide mt-2 inline-block border-b border-white/50 hover:text-brand-cream pb-0.5">Get Directions</a>
                    </div>
                </div>
                
                <div class="flex flex-col md:flex-row items-center md:items-start gap-4">
                    <div class="p-3 bg-white/10 rounded-full">
                        <i class="fa-solid fa-clock text-2xl"></i>
                    </div>
                    <div>
                        <h3 class="font-serif text-xl font-bold mb-1">Opening Hours</h3>
                        <p class="text-white/80 text-sm">Mon - Fri: 9am - 6pm<br>Sat: 10am - 4pm</p>
                    </div>
                </div>

                <div class="flex flex-col md:flex-row items-center md:items-start gap-4">
                    <div class="p-3 bg-white/10 rounded-full">
                        <i class="fa-solid fa-star-of-life text-2xl"></i>
                    </div>
                    <div>
                        <h3 class="font-serif text-xl font-bold mb-1">Services</h3>
                        <p class="text-white/80 text-sm">Acupuncture, Cupping, Herbal Medicine & Wellness Consultation</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW SECTION: Gemini Powered Wellness Insights -->
    <section id="ai-wellness" class="py-20 bg-brand-cream relative overflow-hidden">
        <!-- Decorative bg element -->
        <div class="absolute top-0 right-0 -mr-20 -mt-20 w-96 h-96 bg-brand-green/5 rounded-full blur-3xl"></div>
        
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center mb-10">
                <span class="bg-white/80 px-3 py-1 rounded-full text-xs font-semibold text-brand-green border border-brand-green/20 mb-3 inline-block">
                    <i class="fa-solid fa-sparkles text-amber-500 mr-1"></i> AI Powered
                </span>
                <h2 class="font-serif text-4xl text-brand-green mb-4">Harmonize Your Health</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">
                    Traditional Chinese Medicine (TCM) focuses on balance. Tell our AI Wellness Assistant how you are feeling (e.g., "stressed and not sleeping well"), and receive a personalized insight based on the Five Elements theory.
                </p>
            </div>

            <div class="bg-white rounded-2xl shadow-xl p-8 border border-gray-100">
                <div class="flex flex-col gap-4">
                    <label for="symptom-input" class="text-sm font-semibold text-gray-700">How are you feeling today?</label>
                    <textarea 
                        id="symptom-input" 
                        rows="3" 
                        class="w-full p-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-green focus:border-brand-green transition outline-none resize-none"
                        placeholder="Ex: I feel anxious and have a headache after a long week of work..."
                    ></textarea>
                    
                    <button onclick="getWellnessInsight()" id="generate-btn" class="self-end px-8 py-3 bg-brand-green text-white rounded-full font-medium hover:bg-brand-teal transition shadow-md hover:shadow-lg flex items-center gap-2">
                        <span>Get Wellness Insight</span>
                        <i class="fa-solid fa-wand-magic-sparkles"></i>
                    </button>
                </div>

                <!-- Result Container -->
                <div id="wellness-result" class="hidden mt-8 pt-6 border-t border-gray-100 animate-fade-in">
                    <div class="flex gap-4">
                        <div class="flex-shrink-0">
                            <div class="w-10 h-10 rounded-full bg-brand-sand flex items-center justify-center text-brand-green">
                                <i class="fa-solid fa-yin-yang text-xl"></i>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-serif text-xl font-bold text-brand-green mb-2">TCM Perspective</h4>
                            <div id="wellness-content" class="text-gray-600 leading-relaxed text-sm">
                                <!-- Content will be injected here -->
                            </div>
                            <p class="text-xs text-gray-400 mt-4 italic">
                                *This is AI-generated for educational purposes and is not medical advice. Please consult our practitioners for treatment.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Booking / Map Section -->
    <section id="book" class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row gap-12 items-start">
                <div class="w-full md:w-1/2">
                    <h2 class="font-serif text-4xl text-brand-green mb-6">Ready to start your wellness journey?</h2>
                    <p class="text-gray-600 mb-8">We are located in the heart of Vancouver. Convenient parking is available. Use our online portal to book your next session seamlessly.</p>
                    
                    <div class="bg-gray-50 p-8 rounded-2xl border border-gray-100">
                        <h3 class="font-bold text-gray-800 mb-4">Contact Information</h3>
                        <div class="space-y-4">
                            <a href="tel:+16725335678" class="flex items-center gap-3 text-gray-600 hover:text-brand-green transition">
                                <i class="fa-solid fa-phone text-brand-green"></i> +1 (672) 533-5678
                            </a>
                            <a href="mailto:info@acumotionwellness.com" class="flex items-center gap-3 text-gray-600 hover:text-brand-green transition">
                                <i class="fa-solid fa-envelope text-brand-green"></i> info@acumotionwellness.com
                            </a>
                            <div class="flex items-start gap-3 text-gray-600">
                                <i class="fa-solid fa-map-pin text-brand-green mt-1"></i> 
                                <span>2184 W Broadway Suite 337,<br>Vancouver, BC V6K 2E1, Canada</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="w-full md:w-1/2 h-96 rounded-2xl overflow-hidden shadow-lg relative bg-gray-200">
                     <!-- Google Maps Embed -->
                    <iframe 
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2602.8576426468456!2d-123.15617492326757!3d49.26487107125219!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x548673a3c8e4726b%3A0x600375c78b471018!2s2184%20W%20Broadway%20%23337%2C%20Vancouver%2C%20BC%20V6K%202E1%2C%20Canada!5e0!3m2!1sen!2sde!4v1700000000000!5m2!1sen!2sde" 
                        width="100%" 
                        height="100%" 
                        style="border:0;" 
                        allowfullscreen="" 
                        loading="lazy" 
                        referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-brand-cream border-t border-gray-200 py-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <div class="flex justify-center items-center gap-3 mb-4 text-brand-green">
                <!-- Updated to use the Official Logo Image -->
                <img 
                    src="Richmond_VAN_Canada_Joanne_AcuMotionWellnessé‡ç¸_Logo.png" 
                    alt="Acu Motion Wellness Logo" 
                    class="h-12 w-auto object-contain mix-blend-multiply"
                    onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden');"
                >
                <!-- Fallback icon for footer -->
                <i class="fa-solid fa-leaf text-2xl hidden"></i>
                
                <span class="font-serif font-bold text-xl">Acu Motion Wellness</span>
            </div>
            <p class="text-gray-500 text-sm mb-6">Traditional Care for the Modern World.</p>
            <div class="text-gray-400 text-xs">
                &copy; 2024 Acu Motion Wellness. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Chatbot Widget (Gemini Powered) -->
    <div id="chatbot-container" class="fixed bottom-6 right-6 z-50 flex flex-col items-end">
        
        <!-- Chat Window (Hidden by default) -->
        <div id="chat-window" class="hidden mb-4 w-[350px] bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden flex flex-col transition-all origin-bottom-right">
            <!-- Header -->
            <div class="bg-brand-green p-4 flex justify-between items-center text-white">
                <div class="flex items-center gap-3">
                    <div class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></div>
                    <div>
                        <span class="font-semibold block text-sm">Reception Assistant</span>
                        <span class="text-[10px] text-green-200 uppercase tracking-wider flex items-center gap-1"><i class="fa-solid fa-sparkles text-[8px]"></i> AI Powered</span>
                    </div>
                </div>
                <button onclick="toggleChat()" class="hover:bg-white/20 rounded-full p-1 transition">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            
            <!-- Messages Area -->
            <div id="chat-messages" class="h-80 bg-gray-50 p-4 overflow-y-auto no-scrollbar flex flex-col gap-3">
                <div class="bg-white p-3 rounded-tr-xl rounded-bl-xl rounded-br-xl shadow-sm text-sm text-gray-700 max-w-[85%] border border-gray-100 self-start">
                    Hi there! ðŸ‘‹ I am the Acu Motion AI assistant.
                </div>
                <div class="bg-white p-3 rounded-tr-xl rounded-bl-xl rounded-br-xl shadow-sm text-sm text-gray-700 max-w-[85%] border border-gray-100 self-start">
                    Ask me about our services, location, or booking process!
                </div>
            </div>
            
            <!-- Input Area -->
            <div class="p-4 bg-white border-t border-gray-100">
                <div class="flex gap-2">
                    <input type="text" id="chat-input" placeholder="Type a message..." class="flex-1 bg-gray-100 rounded-full px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-brand-green/50">
                    <button onclick="sendMessage()" id="send-btn" class="w-9 h-9 bg-brand-green text-white rounded-full flex items-center justify-center hover:bg-brand-teal transition">
                        <i class="fa-solid fa-paper-plane text-xs"></i>
                    </button>
                </div>
                <div class="text-[10px] text-center text-gray-400 mt-2">Powered by Google Gemini</div>
            </div>
        </div>

        <!-- Toggle Button -->
        <button onclick="toggleChat()" class="h-14 w-14 bg-brand-green text-white rounded-full shadow-lg hover:bg-brand-teal hover:scale-105 transition-all duration-300 flex items-center justify-center relative group">
            <i class="fa-regular fa-comment-dots text-2xl group-hover:hidden"></i>
            <i class="fa-solid fa-chevron-down text-xl hidden group-hover:block"></i>
            <!-- Notification Badge -->
            <span class="absolute -top-1 -right-1 h-4 w-4 bg-red-500 rounded-full border-2 border-white"></span>
        </button>
    </div>

    <script>
        // API Configuration
        const apiKey = ""; // Runtime provided key
        
        // --- Gemini API Helper Function ---
        async function callGeminiAPI(userPrompt, systemInstruction) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: userPrompt }] }],
                systemInstruction: { parts: [{ text: systemInstruction }] }
            };

            // Retry logic for robustness
            for (let i = 0; i < 3; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    
                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text || "I'm having trouble thinking right now. Please try again.";
                } catch (error) {
                    console.error("Gemini API Error:", error);
                    if (i === 2) return "I apologize, but I am currently experiencing connection issues. Please call us directly at (672) 533-5678.";
                    await new Promise(r => setTimeout(r, 1000 * Math.pow(2, i))); // Exponential backoff
                }
            }
        }

        // --- Feature 1: Harmonize Your Health ---
        async function getWellnessInsight() {
            const input = document.getElementById('symptom-input');
            const resultContainer = document.getElementById('wellness-result');
            const resultContent = document.getElementById('wellness-content');
            const btn = document.getElementById('generate-btn');

            if (!input.value.trim()) return;

            // UI Loading State
            const originalBtnText = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Analyzing...';
            btn.disabled = true;

            const systemPrompt = `
                You are a wise and calming Traditional Chinese Medicine (TCM) practitioner assistant. 
                Analyze the user's description of their feelings or symptoms. 
                Identify which of the Five Elements (Wood, Fire, Earth, Metal, Water) might be out of balance.
                Provide a warm, empathetic response that includes:
                1. A brief TCM interpretation (mentioning Qi, Yin/Yang, or Elements).
                2. One simple, actionable lifestyle or dietary tip to help restore balance.
                Keep it under 60 words. 
                Always maintain a soothing tone.
                Disclaimer: Do not provide medical diagnoses.
            `;

            const insight = await callGeminiAPI(input.value, systemPrompt);

            // Update UI
            resultContent.innerHTML = insight.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>'); // Basic markdown bold support
            resultContainer.classList.remove('hidden');
            
            // Reset Button
            btn.innerHTML = originalBtnText;
            btn.disabled = false;
        }


        // --- Feature 2: Chatbot Logic ---
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        function toggleChat() {
            const chatWindow = document.getElementById('chat-window');
            if (chatWindow.classList.contains('hidden')) {
                chatWindow.classList.remove('hidden');
                chatWindow.classList.add('chat-animate');
            } else {
                chatWindow.classList.add('hidden');
                chatWindow.classList.remove('chat-animate');
            }
        }

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const messagesArea = document.getElementById('chat-messages');
            const sendBtn = document.getElementById('send-btn');
            const messageText = input.value.trim();
            
            if (messageText === "") return;

            // 1. Add User Message
            addMessageToUI(messageText, 'user');
            input.value = "";
            
            // 2. Show Typing Indicator
            const typingId = addTypingIndicator();
            scrollToBottom();

            // 3. Call Gemini
            const systemPrompt = `
                You are the AI Receptionist for 'Acu Motion Wellness', a Chinese Medicine clinic in Vancouver/Richmond.
                Address: 2184 W Broadway Suite 337, Vancouver, BC V6K 2E1.
                Phone: +1 (672) 533-5678.
                Hours: Mon-Fri 9am-6pm, Sat 10am-4pm.
                Services: Acupuncture, Cupping, Herbal Medicine.
                Tone: Professional, warm, inviting, and efficient.
                Goal: Answer user questions briefly. Encourage booking appointments via the 'Book Appointment' button.
                Constraint: Keep responses under 40 words unless detailed info is requested.
            `;
            
            const responseText = await callGeminiAPI(messageText, systemPrompt);

            // 4. Remove Typing Indicator & Add Bot Response
            removeTypingIndicator(typingId);
            addMessageToUI(responseText, 'bot');
            scrollToBottom();
        }

        function addMessageToUI(text, sender) {
            const messagesArea = document.getElementById('chat-messages');
            const div = document.createElement('div');
            
            if (sender === 'user') {
                div.className = "bg-brand-green text-white p-3 rounded-tl-xl rounded-bl-xl rounded-br-xl shadow-sm text-sm max-w-[85%] self-end chat-animate";
            } else {
                div.className = "bg-white p-3 rounded-tr-xl rounded-bl-xl rounded-br-xl shadow-sm text-sm text-gray-700 max-w-[85%] border border-gray-100 self-start chat-animate";
                // Basic link conversion (simple regex for demonstration)
                text = text.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" class="text-brand-green underline font-semibold">link</a>');
            }
            
            div.innerHTML = text;
            messagesArea.appendChild(div);
        }

        function addTypingIndicator() {
            const messagesArea = document.getElementById('chat-messages');
            const id = 'typing-' + Date.now();
            const div = document.createElement('div');
            div.id = id;
            div.className = "bg-white p-4 rounded-tr-xl rounded-bl-xl rounded-br-xl shadow-sm max-w-[50px] border border-gray-100 self-start chat-animate";
            div.innerHTML = '<div class="typing-indicator"><span></span><span></span><span></span></div>';
            messagesArea.appendChild(div);
            return id;
        }

        function removeTypingIndicator(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }

        function scrollToBottom() {
            const msgArea = document.getElementById('chat-messages');
            msgArea.scrollTop = msgArea.scrollHeight;
        }
        
        // Allow Enter key to send
        document.getElementById('chat-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>